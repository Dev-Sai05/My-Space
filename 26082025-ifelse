<FOLDER Name="COBOL Structural Checks" Category="" System="False" 
        Description="Rules to detect COBOL structural issues such as unbalanced IF/END-IF.">

    <!-- Rule 1: IF without END-IF -->
    <CRITERION Name="Detect IF without END-IF" Category="" System="False" 
               ErrorCode="MFCA2001" 
               Description="This rule finds IF statements that do not have a matching END-IF.">
        <ENTITY Name="IF" Descendants="False"/>
        <REL Name=".EndIf" Op="not-exists">
            <ENTITY Name="END-IF" Descendants="False"/>
        </REL>
    </CRITERION>

    <!-- Rule 2: END-IF without IF -->
    <CRITERION Name="Detect END-IF without IF" Category="" System="False" 
               ErrorCode="MFCA2002" 
               Description="This rule finds END-IF statements that do not match an IF.">
        <ENTITY Name="END-IF" Descendants="False"/>
        <REL Name=".Parent" Op="not-exists">
            <ENTITY Name="IF" Descendants="False"/>
        </REL>
    </CRITERION>

    <!-- Rule 3: ELSE without matching IF -->
    <CRITERION Name="Detect ELSE without IF" Category="" System="False" 
               ErrorCode="MFCA2003" 
               Description="This rule finds ELSE statements not tied to an IF.">
        <ENTITY Name="ELSE" Descendants="False"/>
        <REL Name=".Parent" Op="not-exists">
            <ENTITY Name="IF" Descendants="False"/>
        </REL>
    </CRITERION>

</FOLDER>
--------------------------------------------------------

		<CRITERION Name="GO TO Statements Targeting non-EXIT Paragraphs" Category="" System="False" ErrorCode="MFCA1103" Description="This query is designed to find instances where a GO TO statement branches to a paragraph that is not an exit paragraph, or does not contain any type of program termination.  The result set should also be reviewed for instances of unsuitable backward branching. See the IBM 'Enterprise COBOL for z/OS Programming Guide Version 3 Release 4 SC27-1412-05' for further details.">
			<ENTITY Name="GOTO"/>
			<COND Type="and">
				<REL Name=".Go to" Op="has">
					<ENTITY Name="PAR" Descendants="True"/>
					<COND Type="and">
						<REL Name=":Contains" Op="hasno">
							<ENTITY Name="STAT"/>
							<ATTR Name=".Kind" Op="=">
								<ITEM Value="Exit"/>
								</ATTR>
						</REL>
						<REL Name=":Contains" Op="hasno">
							<ENTITY Name="STOP"/>
						</REL>
						<REL Name=":Contains" Op="hasno">
							<ENTITY Name="PORT" Descendants="False"/>
							<ATTR Name=".PORTTYPE" Op="=">
								<ITEM Value="XFER"/>
								<ITEM Value="TRANS"/>
							</ATTR>
						</REL>
					</COND>
				</REL>
				<REL Name=":IsNested" Op="hasno">
					<ENTITY Name="EXEC" Descendants="False"/>
				</REL>
			</COND>
		</CRITERION>
